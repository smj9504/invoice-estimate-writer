<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Estimate</title>
  <link rel="stylesheet" href="estimate_style.css">
</head>
<body>

<div class="header-top">
  <div class="invoice-meta">
    <h1>Estimate</h1>
    <p><strong>Estimate number</strong> {{ estimate_number }}</p>
    <p>Estimate Date: {{ estimate_date }}</p>
  </div>

  <div class="company-logo">
    {% if company.logo %}
    <img src="{{ company.logo }}" alt="" class="logo">
    {% endif %}
  </div>
</div>

<div class="address-section">
  <div class="company-info">
    <p><strong>{{ company.name }}</strong></p>
    <p>{{ company.address }}</p>
    <p>{{ company.city }}, {{ company.state }} {{ company.zip }}</p>
    <p>{{ company.phone }}</p>
    <p>{{ company.email }}</p>
  </div>
  <div class="client-info">
    <p><strong>Estimate for</strong></p>
    {% if client.name %}
      <p>{{ client.name }}</p>
    {% endif %}
    <p>{{ client.address }}</p>
    <p>{{ client.city }}, {{ client.state }} {{ client.zip }}</p>
    {% if client.phone %}
      <p>{{ client.phone }}</p>
    {% endif %}
     {% if client.email %}
      <p>{{ client.email }}</p>
    {% endif %}
  </div>
</div>

{% if top_note %}
  <p class="amount-due-note">{{ top_note.replace('\n', '<br>') | safe }}</p>
{% endif %}

<div class="line-header">
  <div class="col-item">Item</div>
  <div class="col-qty">Qty</div>
  <div class="col-unit">Unit</div>
  <div class="col-price">Price</div>
  <div class="col-total">Total</div>
</div>

{% for section in serviceSections %}
  <div class="section-title">{{ section.title }}</div>

  {% for item in section["items"] %}
    {% if item.name and item.qty and item.unit and item.price %}
    <div class="line-row">
      <div class="col-item">{{ loop.index }}. {{ item.name }}</div>
      <div class="col-qty">{{ "{:,.2f}".format(item.qty | float) }}</div>
      <div class="col-unit">{{ item.unit }}</div>
      <div class="col-price">${{ "{:,.2f}".format(item.price | float) }}</div>
      <div class="col-total">${{ "{:,.2f}".format(item.qty * item.price | float) }}</div>
    </div>
    {% if item.dec %}
    <div>
      <p class="col-desc">{{ item.dec.replace('\n', '<br>') | safe }}</p>
    </div>
    {% endif %}
    {% endif %}
  {% endfor %}   

  {% if section.showSubtotal %}
  <p class="subtotal">Subtotal: ${{ "{:,.2f}".format(section.subtotal) }}</p>
  {% endif %}
{% endfor %}

<div class="footer-total">
  <p>Subtotal: ${{ "{:,.2f}".format(subtotal) }}</p>
  {% if op_percent and op_percent > 0 %}
    <p>O&amp;P ({{ op_percent|round|int }}%): ${{ "{:,.2f}".format(op_amount) }}</p>
  {% endif %}
  {% if discount %}
    <p>Discount: -${{ "{:,.2f}".format(discount) }}</p>
  {% endif %}
  <p class="total">Estimate Total: ${{ "{:,.2f}".format(total) }}</p>
</div>

{% if bottom_note %}
  <p class="note">{{ bottom_note.replace('\n', '<br>') | safe }}</p>
{% endif %}

{% if disclaimer %}
  <p class="disclaimer">{{ disclaimer.replace('\n', '<br>') | safe }}</p>
{% endif %}

</body>
</html>
